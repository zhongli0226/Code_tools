有限状态机的一种实现方式，可以按照模板编写代码